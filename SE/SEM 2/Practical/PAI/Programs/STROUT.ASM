INTIALIZE MACRO
   MOV AX,0000H
   MOV BX,AX
   MOV DX,AX
   MOV CX,AX
ENDM


DISPNL MACRO 

	LEA DX,NEWLINE
	MOV AH,09H
	INT 21H

ENDM 

DISP MACRO MSG
   INTIALIZE
   LEA DX,MSG
   MOV AH,09H
   INT 21H
ENDM

DISPN MACRO 
   MOV AH,02H
   INT 21H
ENDM

DISPCOUNT MACRO COUNT,MSG

		
		DISP MSG
		MOV DL,COUNT
		ADD DL,30H
		DISPN


ENDM

.model small
.data
	EXTRN STR1:BYTE
	EXTRN STR2:BYTE
	
	STR3 DB 10 DUP('$')
	NEWLINE DB 10,13,'$'
	EN DB '$'
	INVALIDMSG DB 10,'INVALID$'
	CMPNMSG DB 10,'NOT EQUAL$'
	CMPYMSG DB 10,'EQUAL$'
	SPMSG DB 10,'SPACE : $'
	NMMSG DB 10,'NUMBERS : $'
	LOWMSG DB 10,'LOWER CASE LETTERS : $'
	CAPMSG DB 10,'CAPITAL LETTERS : $'
	
	;BREAKPOINTS FOR DEBUGGING PURPOSE
	B1 DB 10,'B>A$'
	B2 DB 10,'IN VALID$'
	B3 DB 10,'CHAR NOT FOUND$'
	
	SPACEC DB 0	; SPACE COUNT 
	CAPLC DB 0	; CAPITAL LETTER COUNT
	LOWLC DB 0	; LOWER LETTER COUNT 
	NUMC DB 0	; NUMBER COUNT
	
	
.code
	
        MOV AX,@data
        MOV DS,AX
        MOV ES,AX
 	
 	
 	PUBLIC DISPFAR
 	DISPFAR PROC FAR 
 	  	DISPNL
 		INTIALIZE
 		LEA DX,STR1+2
 		MOV AH,09H
   		INT 21H
   		RET
 	ENDP
 	
 	
 	PUBLIC INPUTSTR
 	INPUTSTR PROC FAR 
 		INTIALIZE
          	 LEA DX,STR1
          	 MOV AH,0AH
          	 INT 21H
   		RET
 	ENDP
 	
 	PUBLIC INPUTSTR2
 	INPUTSTR2 PROC FAR 
 		INTIALIZE
          	 LEA DX,STR2
          	 MOV AH,0AH
          	 INT 21H
   		RET
 	ENDP
 	
 	
 	
 	PUBLIC CONCAT
 	CONCAT PROC FAR 
 		INTIALIZE
 		
 		MOV CH,00H
 		MOV CL,STR1+1
 		LEA SI,STR1+2
 		LEA DI,STR3+2
 		REP MOVSB
 		
 		MOV CH,00H
 		MOV CL,STR2+1
 		LEA SI,STR2+2
 		REP MOVSB
 		
 		MOV AL,EN
 		MOV [DI],AL
 		DISP STR3+2		
 		
   		RET
 	ENDP
 	
 	PUBLIC STRCMP
 	STRCMP PROC FAR 
 		INTIALIZE
 		MOV CH,00H
 		MOV AL,STR1+1
 		MOV BL,STR2+1
 		CMP AL,BL
 		JNE SV
 		
 		MOV CH,00H
 		MOV CL,STR1+1
 		LEA SI,STR1+2
 		LEA DI,STR2+2
 		REPE CMPSB
 		CMP CL,00H
 		JNE SV
 		DISP CMPYMSG
 		JMP EXIT
 
 	SV:
 		DISP CMPNMSG
 	EXIT:	
   		RET
 	ENDP
 	
 	
 	PUBLIC SUBSTRING
 	SUBSTRING PROC FAR 
 		INTIALIZE
 		MOV AL,STR1+1
 		MOV BL,STR2+1
 		CMP BL,AL
 		JB VALID
 		DISP B1
 		JMP INVALID
 		
 	VALID:
 		DISP B2
 		MOV CH,00H
 		MOV CL,STR1+1
 		LEA SI,STR1+2
 		LEA DI,STR2+2
 		
 	LOOP1:
 		MOV AL,[SI]
 		MOV BL,[DI]
 		CMP BL,AL
 		JE NEXT
 		INC SI
 		DEC CL
 		JNZ LOOP1
 		DISP B3
 		JMP INVALID
 	NEXT: 	
 		MOV CH,00H
 		MOV CL,STR2+1
 		
 		LEA DI,STR2+2
 		REPE CMPSB
 		
 		CMP CL,00H
 		JNE INVALID
 		DISP CMPYMSG
 		JMP EXIT2
      INVALID:
 		DISP CMPNMSG
 		
 		
 		
 		
 	EXIT2:
   		RET
 	ENDP
 	
 	PUBLIC COUNTCHAR
 	COUNTCHAR PROC FAR 
		INTIALIZE
		MOV SPACEC,AL
		MOV NUMC,AL
		MOV CAPLC,AL
		MOV LOWLC,AL
		
		
		LEA SI,STR1+1
		MOV AL,[SI]
		MOV CL,AL
	UP:	
		INC SI
		MOV AL,[SI]
		CMP AL,20H
		JB EXIT3
		JE SPACEINT
		
		CMP AL,30H
		JB EXIT3
		CMP AL,39H
		JBE NUMINT
		
		CMP AL,41H
		JB EXIT3
		CMP AL,5AH
		JBE CAPINT
		
		CMP AL,61H
		JB EXIT3
		CMP AL,7AH
		JBE LOWINT
		
   		SPACEINT:
   			INC SPACEC
   			JMP COUNTER
   		CAPINT:
   			INC CAPLC
			JMP COUNTER   		
   		LOWINT:
   			INC LOWLC
			JMP COUNTER   		
   		NUMINT:
   			INC NUMC
			JMP COUNTER   		
   		COUNTER:
   			DEC CL
   			CMP CL,00H
   			JNE UP

	
		
		EXIT3:
		
		DISP STR1
		DISPCOUNT SPACEC,SPMSG
		DISPCOUNT NUMC,NMMSG
		DISPCOUNT CAPLC,CAPMSG
		DISPCOUNT LOWLC,LOWMSG 
		
		
   		
   		RET
 	ENDP


	MOV AH,4CH
	INT 21H
END
